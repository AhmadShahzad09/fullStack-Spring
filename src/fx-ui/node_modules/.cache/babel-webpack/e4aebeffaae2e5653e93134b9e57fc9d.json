{"ast":null,"code":"import _asyncToGenerator from \"/workspaces/fx-deals/src/fx-ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { FxDealDialogComponent } from './fx-deal-dialog/fx-deal-dialog.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/material/dialog\";\nimport * as i2 from \"./data.service\";\nimport * as i3 from \"./top-bar/top-bar.component\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"./fx-deal-search/fx-deal-search.component\";\nimport * as i6 from \"./fx-deal-list/fx-deal-list.component\";\nimport * as i7 from \"@angular/material/progress-spinner\";\nconst _c0 = [\"list\"];\n\nfunction AppComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵelement(1, \"mat-spinner\", 9);\n    i0.ɵɵelementEnd();\n  }\n}\n\nconst _c1 = function (a0, a1) {\n  return {\n    \"alert-danger\": a0,\n    \"alert-success\": a1\n  };\n};\n\nfunction AppComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵelementStart(1, \"span\", 11);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(2, _c1, ctx_r1.alertState.status === \"danger\", ctx_r1.alertState.status === \"success\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.alertState.message, \" \");\n  }\n}\n\nexport let AppComponent = /*#__PURE__*/(() => {\n  class AppComponent {\n    constructor(dialog, dataService) {\n      this.dialog = dialog;\n      this.dataService = dataService;\n      this.title = 'fx-ui';\n      this.loading = true;\n      this.alertState = {\n        visible: false,\n        status: '',\n        message: ''\n      };\n    }\n\n    openDialog() {\n      const dialogRef = this.dialog.open(FxDealDialogComponent);\n      dialogRef.afterClosed().subscribe(result => {\n        if (result) {\n          result.timestamp = new Date().toJSON();\n          this.createFxDeal(result);\n        }\n      });\n    }\n\n    createFxDeal(fxDeal) {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        _this.loading = true;\n\n        try {\n          const response = yield _this.dataService.createFxDeal(fxDeal);\n\n          if (!response.ok) {\n            const {\n              error\n            } = yield response.json();\n\n            _this.setAlertState({\n              visible: true,\n              status: 'danger',\n              message: error.message\n            });\n\n            return;\n          }\n\n          _this.setAlertState({\n            visible: true,\n            status: 'success',\n            message: 'Success!'\n          });\n\n          _this.refreshList();\n        } catch (e) {\n          _this.setAlertState({\n            visible: true,\n            status: 'danger',\n            message: 'Error!'\n          });\n        } finally {\n          _this.loading = false;\n        }\n      })();\n    }\n\n    setAlertState(alertState) {\n      this.alertState = alertState; // show alert for 3 seconds\n\n      setTimeout(() => {\n        this.alertState.visible = false;\n      }, 3000);\n    }\n\n    onLoading(status) {\n      this.loading = status;\n    }\n\n    refreshList() {\n      var _a;\n\n      (_a = this.list) === null || _a === void 0 ? void 0 : _a.getAllFxDeals();\n    }\n\n  }\n\n  AppComponent.ɵfac = function AppComponent_Factory(t) {\n    return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.MatDialog), i0.ɵɵdirectiveInject(i2.DataService));\n  };\n\n  AppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AppComponent,\n    selectors: [[\"app-root\"]],\n    viewQuery: function AppComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.list = _t.first);\n      }\n    },\n    decls: 12,\n    vars: 2,\n    consts: [[\"class\", \"spinner-overlay\", 4, \"ngIf\"], [\"class\", \"alert\", 3, \"ngClass\", 4, \"ngIf\"], [1, \"container\", \"align-right\"], [\"mat-button\", \"\", \"color\", \"primary\", 3, \"click\"], [1, \"container\"], [1, \"row\"], [3, \"alert\", \"loading\"], [\"list\", \"\"], [1, \"spinner-overlay\"], [1, \"spinner\"], [1, \"alert\", 3, \"ngClass\"], [1, \"alert-text\"]],\n    template: function AppComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"app-top-bar\");\n        i0.ɵɵtemplate(1, AppComponent_div_1_Template, 2, 0, \"div\", 0);\n        i0.ɵɵtemplate(2, AppComponent_div_2_Template, 3, 5, \"div\", 1);\n        i0.ɵɵelementStart(3, \"div\", 2);\n        i0.ɵɵelementStart(4, \"button\", 3);\n        i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_4_listener() {\n          return ctx.openDialog();\n        });\n        i0.ɵɵtext(5, \" Create Fx Deal \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"div\", 4);\n        i0.ɵɵelementStart(7, \"div\", 5);\n        i0.ɵɵelementStart(8, \"fx-deal-search\", 6);\n        i0.ɵɵlistener(\"alert\", function AppComponent_Template_fx_deal_search_alert_8_listener($event) {\n          return ctx.setAlertState($event);\n        })(\"loading\", function AppComponent_Template_fx_deal_search_loading_8_listener($event) {\n          return ctx.onLoading($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"div\", 5);\n        i0.ɵɵelementStart(10, \"fx-deal-list\", 6, 7);\n        i0.ɵɵlistener(\"alert\", function AppComponent_Template_fx_deal_list_alert_10_listener($event) {\n          return ctx.setAlertState($event);\n        })(\"loading\", function AppComponent_Template_fx_deal_list_loading_10_listener($event) {\n          return ctx.onLoading($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.loading);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.alertState.visible);\n      }\n    },\n    directives: [i3.TopBarComponent, i4.NgIf, i5.FxDealSearchComponent, i6.FxDealListComponent, i7.MatSpinner, i4.NgClass],\n    styles: [\"\"]\n  });\n  return AppComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}